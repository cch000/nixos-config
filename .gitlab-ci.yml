image: "nixos/nix"

stages:
  - test
  - style

variables:
  flags: '--extra-experimental-features nix-command --extra-experimental-features flakes'

flake-check:
  stage: test
  script: nix ${flags} flake check .

statix:
  stage: style
  script: nix ${flags} run nixpkgs#statix check

deadnix:
  stage: style
  script: nix ${flags} run nixpkgs#deadnix -- -f
